## HogWeed Server

#### Requires:
 - Docker
 - docker-compose > 2.0  
   See [this](https://docs.docker.com/compose/install) for installation instructions for your OS and [this](https://github.com/docker/compose/releases/latest) for latest releases info (tested for [v2.2.3](https://github.com/docker/compose/releases/tag/v2.2.3)).

#### Run using: 
 - Debug + build mode: `docker-compose -f ./docker/docker-compose.yml --env-file=./docker/.env.development up --build`
 - Debug mode: `docker-compose -f ./docker/docker-compose.yml --env-file=./docker/.env.development up`
 - Release mode: `docker-compose -f ./docker/docker-compose.yml --env-file=./docker/.env.production up`
 
### Launch server locally
1. Download `bundled-server.zip` artifact from releases section, open it and unpack, run shell console there
2. Run script `./config-generator [DOMAIN]`, where DOMAIN - is your server domain name
3. Run `docker-compose -f ./docker-compose.yml --env-file=./system-config.env up`
4. Enjoy your server!  
NB! All the generated `*config.env` files are safe to edit BEFORE the first server launch. After that you shouldn't be modified in any way.
NB! By default, server runs on HTTPS, redirecting all HTTP traffic there. Ports for HTTP and HTTPS can be found in `./system-config.env up`, make sure they are free and available to use!  
NB! HTTPS certificates stored in `./certificates` folder are auto-generated and self-signed. Feel free to replace them with trusted ones.  
NB! Superuser email and password for accessing admin website are stored in `./config.env` file (DJANGO_SUPERUSER_EMAIL and DJANGO_SUPERUSER_PASSWORD respectively).

Configs structure:
1. `config.env` - user configuration file (will be generated by `config-generator.sh` script):
   ```properties
   DJANGO_SECRET=[Secret, generated for current production build (visit https://djecrety.ir for secure key generation), required!]
   DJANGO_HOST=[Domain name this server is running on (if multiple names available, write with dividing whitespace: 'example1.com example2.com example3.com'), by default available on localhost only, required!]
   
   DJANGO_SUPERUSER_EMAIL=[E-mail address of administrator - default superuser of the server, default: 'admin@site.com']
   DJANGO_SUPERUSER_PASSWORD=[Password of administrator - default superuser of the server, default: '12345678']
   
   POSTGRES_HOST=[Device, the PostgreSQL instance is running on (required for local run only, default: 'localhost')]
   POSTGRES_PORT=[Device, the PostgreSQL instance is running on (default: '5432')]
   
   POSTGRES_NAME=[Name of the database assigned for the server (in docker any name will fit), required!]
   POSTGRES_USER=[Username, all database calls will be signed with (in docker any username will fit), required!]
   POSTGRES_PASSWORD=[Password for accessing database with given username (in docker any password will fit), required!]
   ```
2. `system-config.env` - user configuration file:
   ```properties
   ENV=[Environment of server, specifies logging level and use of HTTP/HTTPS, must be one of: (development, production), required!]
   COMPOSE_PROJECT_NAME=[Name of docker-compose project, must be different for different server instances (e.g. running on the same device), required!]
   MOCK_SMTP_SERVER=[Defines whether e-mail sending should be mocked (email will be transferred as HTTP response in that case), must be one of: (True, False), required!]
   
   SERVER_PORT_HTTP=[Host port that will be used to serve server for HTTP (makes sense for ENV=development only), required!]
   SERVER_PORT_HTTPS=[Host port that will be used to serve server for HTTPS (makes sense for ENV=production only), required!]
   ```

### HogWeed Server roadmap:
- [x] Server website
- [x] Server API
- [x] Server API testing (in docker and locally)
- [ ] Server settings (backup, logs, admin notifications)
- [ ] Languages + translation
- [ ] Different authentication methods and providers
