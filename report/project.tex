% !TeX spellcheck = russian-aot

\section{Проектирование решения}

\tab
Для реализации системы была выбрана клиент-серверная архитектура.

\tab
Данные собираются на сервере и сохраняются в базе данных при помощи серверной части ПО.
Она позволяет специалистам и администраторам системы работать с данными при помощи специализированного сервисного сайта.
Она же обеспечивает функционирование API системы, часть методов которого не требуют аутентификации и позволяют получать обработанные, отсортированные и отфильтрованные данные, а часть - требует и позволяет отправлять новые данные в систему.

\tab
Получить доступ к этим данным можно при помощи приложения-клиента или любого сайта, который сделает запрос к API системы.
Приложение клиент также позволяет пользователям управлять своим аккаунтом, собирать данные в отчёт и отправлять его в систему.

\tab
Схема архитектуры представлена на рисунке 1.
\pictureone

\subsection{Сценарии использования}

\tab
Были разработаны следующие сценарии использования:
\input{scenarios}

\subsection{Политика конфиденциальности}

\tab
Так как для регистрации в системе пользователям необходимо указать и подтвердить их адрес электронной почты, а также в процессе работы с системой они могут загружать в неё фотоматериалы, администрации системы необходимо получить информированное согласие пользователей на обработку их конфиденциальных данных\cite{privacy-policy}.

\tab
Для проектируемой системы был составлен пример политики конфиденциальности (детали могут различаться в зависимости от целей и задач организации, использующей систему), её основные положения заключаются в следующем:
\begin{itemize}
	\item Система в обязательном порядке собирает и хранит личные данные пользователей, необходимые для связи с ними в экстренной ситуации (их адрес электронной почты).
	\item Администрация системы имеет право использовать эти данные для связи с пользователями.
	\item Эти данные не передаются третьим лицам (в том числе и другим пользователям).
	\item Такие данные навсегда удаляются из системы вместе с аккаунтом пользователя.
	\item Все остальные личные данные (такие как имя пользователя и фотографии, прикреплённые к оставляемым им отчётам) оставляются пользователем исключительно по его желанию.
	\item Такие данные могут обрабатываться автоматически или вручную неограниченным кругом лиц и будут распространяться открыто.
	\item Такие данные не удаляются из системы при удалении аккаунта пользователя, так как могут представлять статистическую или исследовательскую ценность, но могут быть удалены по запросу пользователя или в связи с решением администрации системы.
\end{itemize}

\subsection{Модель данных}

\tab
База данных была спроектирована с помощью ER-метода (метода \textquote{сущность‐связь}).
Для этого была создана ER‐модель, показывающая как атрибуты сущностей предметной области, так и их связи.
Атрибут или атрибуты, уникально идентифицирующие сущность, называются ключевыми, далее они подчёркнуты.

\subsubsection{Описание сущностей}

\tab
В предметной области можно выделить следующие сущности:
\begin{itemize}
	\item \textquote{Пользователь} с ключом \textquote{Номер пользователя} и атрибутами: \textquote{Адрес электронной почты}, \textquote{Хэш сумма пароля}, \textquote{Имя}, \textquote{Дата регистрации в системе}, \textquote{Время последнего входа в систему}, \textquote{Является ли пользователь администратором}, \textquote{Является ли пользователь специалистом}, \textquote{Активен ли аккаунт пользователя}, \textquote{Фото профиля} и \textquote{Уменьшенное фото профиля}. Адрес электронной почты также уникален для сущности \textquote{Пользователь}, но, согласно политике конфиденциальности, его нельзя распространять при помощи публичного API, поэтому использовать его в качестве ключа невозможно.
	\item \textquote{Отчёт} с ключом \textquote{Номер отчёта} и атрибутами: \textquote{Дата и время наблюдения}, \textquote{Адрес}, \textquote{Первый комментарий}, \textquote{Координаты}, \textquote{Статус} и \textquote{Вид растения}.
	\item \textquote{Фотография} с ключом \textquote{Номер фотографии} и атрибутами: \textquote{Фотография} и \textquote{Уменьшенная фотография}
	\item \textquote{Комментарий} с ключом \textquote{Номер комментария} и с атрибутом: \textquote{Текст комментария}.
\end{itemize}

\subsubsection{ER модель}

\tab
Между сущностями можно установить следующие связи:
\begin{itemize}
	\item \textquote{Пользователь - Отчёт}: пользователь оставляет отчёт о наблюдении потенциально опасного для человека растения. Пользователь может не оставлять отчётов, оставить один или несколько. Отчёт может быть оставлен существующим или удалённым пользователем. Связь не обязательная с обеих сторон, имеет степень 1 со стороны пользователя и n со стороны отчёта.
	\item \textquote{Пользователь - Комментарий}: пользователь оставляет комментарий к отчёту. Пользователь может не оставлять комментариев, оставить один или несколько. Комментарий может быть оставлен существующим или удалённым пользователем. Связь не обязательная с обеих сторон, имеет степень 1 со стороны пользователя и n со стороны комментария.
	\item \textquote{Отчёт - Комментарий}: комментарий относится к какому-либо отчёту. К отчёту может не относиться ни одного комментария, относиться один или несколько. Комментарий относится только к одному отчёту. Связь обязательная со стороны комментария и не обязательная со стороны отчёта, имеет степень 1 со стороны отчёта и n со стороны комментария.
	\item \textquote{Отчёт - Фотография}: фотография прикреплена к какому-либо отчёту. К каждому отчёту может быть не прикреплено ни одной фотографии, прикреплена одна или несколько. Каждая фотография прикреплена к какому-либо отчёту. Связь обязательная со стороны фотографии и не обязательная со стороны отчёта, имеет степень 1 со стороны отчёта и n со стороны комментария.
\end{itemize}

\tab
На рисунке 2 представлена ER диаграмма модели.
\picturetwo

\subsubsection{Реляционная модель}

\tab
Связь \textquote{Пользователь - Отчёт} образует два отношения - по одному для каждой сущности, в отношение \textquote{Отчёт} добавляются ключевые атрибуты сущности \textquote{Пользователь}:
\begin{itemize}
	\item Пользователь (\under{Номер пользователя}).
	\item Отчёт (\under{Номер отчёта}, Номер пользователя).
\end{itemize}

\tab
Связь \textquote{Пользователь - Комментарий} образует два отношения - по одному для каждой сущности, в отношение \textquote{Комментарий} добавляются ключевые атрибуты сущности \textquote{Пользователь}:
\begin{itemize}
	\item Пользователь (\under{Номер пользователя}).
	\item Комментарий (Номер отчёта, Номер пользователя).
\end{itemize}

\tab
Связь \textquote{Отчёт - Комментарий} образует два отношения - по одному для каждой сущности, в отношение \textquote{Комментарий} добавляются ключевые атрибуты сущности \textquote{Отчёт}:
\begin{itemize}
	\item Отчёт (\under{Номер отчёта}, Номер пользователя).
	\item Комментарий (Номер отчёта).
\end{itemize}

\tab
Связь \textquote{Отчёт - Фотография} образует два отношения - по одному для каждой сущности, в отношение \textquote{Фотография} добавляются ключевые атрибуты сущности \textquote{Отчёт}:
\begin{itemize}
	\item Отчёт (\under{Номер отчёта}, Номер пользователя).
	\item Фотография (Номер отчёта).
\end{itemize}

\tab
Оставшиеся атрибуты предметной области были распределены между отношениями следующим образом:
\begin{itemize}
	\item Пользователь (\under{Номер пользователя}, Адрес электронной почты, Хэш сумма пароля, Имя, Дата регистрации в системе, Время последнего входа в систему, Является ли пользователь администратором, Является ли пользователь специалистом, Активен ли аккаунт пользователя, Фото профиля, Уменьшенное фото профиля).
	\item Отчёт (\under{Номер отчёта}, Номер пользователя, Дата и время наблюдения, Адрес, Первый комментарий, Координаты, Статус, Вид растения).
	\item Фотография (\under{Номер фотографии}, Номер отчёта, Фотография, Уменьшенная фотография).
	\item Комментарий (\under{Номер комментария}, Номер пользователя, Номер отчёта, Текст комментария).
\end{itemize}

\tab
Все отношения отражают объекты или зависимости предметной области, избыточных отношений нет.
На рисунке 3 представлена реляционная модель базы данных.
\picturethree

\subsection{Описание пользовательского интерфейса}

\tab
В соответствии со сценариями использования был разработан макет пользовательского интерфейса.
\additionref{interface}{Приложении А}.

\subsubsection{Пользовательский интерфейс клиентского приложения}

\subsubsection{Пользовательский интерфейс сервисного сайта}

